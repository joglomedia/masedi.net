<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Configuring the SQL Interface</title>
    <link rel="stylesheet" href="gettingStarted.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="start" href="index.html" title="Berkeley DB Installation and Build Guide" />
    <link rel="up" href="build_unix.html" title="Chapter 6.  Building Berkeley DB for UNIX/POSIX" />
    <link rel="prev" href="build_unix_conf.html" title="Configuring Berkeley DB" />
    <link rel="next" href="build_unix_small.html" title="Building a small memory footprint library" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Configuring the SQL Interface</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="build_unix_conf.html">Prev</a> </td>
          <th width="60%" align="center">Chapter 6. 
		Building Berkeley DB for UNIX/POSIX
        </th>
          <td width="20%" align="right"> <a accesskey="n" href="build_unix_small.html">Next</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title" style="clear: both"><a id="build_unix_sql"></a>Configuring the SQL Interface</h2>
          </div>
        </div>
      </div>
      <div class="toc">
        <dl>
          <dt>
            <span class="sect2">
              <a href="build_unix_sql.html#id3768745">Enabling Extensions</a>
            </span>
          </dt>
          <dt>
            <span class="sect2">
              <a href="build_unix_sql.html#id3770365">Building the JDBC Driver
</a>
            </span>
          </dt>
          <dt>
            <span class="sect2">
              <a href="build_unix_sql.html#id3770568">Building the ODBC Driver</a>
            </span>
          </dt>
        </dl>
      </div>
      <p>There are a set of configuration options to assist you in building the Berkeley DB SQL interface. These configuration options include: </p>
      <div class="variablelist">
        <dl>
          <dt>
            <span class="term"></span>
          </dt>
          <dd>To build the command line interpreter dbsql, enter
--enable-sql as an argument to configure. Along with dbsql, this argument also builds the libdb_sqlXX.{so|la} library, a C API library that mirrors the SQLite C API.</dd>
        </dl>
      </div>
      <div class="variablelist">
        <dl>
          <dt>
            <span class="term"></span>
          </dt>
          <dd>To build the command line tool sqlite3, enter
--enable-sql_compat as an argument to configure. sqlite3 enables you to manually enter and execute SQL commands. The sqlite3 command line tool is identical to the dbsql executable but named so that existing scripts for SQLite can easily work with Berkeley DB. Along with sqlite3, this argument also builds libsqlite3.{so|la}, a C API library.  libsqlite3.{so|la} mirrors the SQLite C API, and has the same name as the library generated by an SQLite build also for ease of use with existing sripts.
In addition to building sqlite3 and libsqlite3.{so|la}, the --enable-sql_compat argument also builds a libdb_sqlXX.{so|la} and dbsql, as is done with the --enable-sql argument.
</dd>
        </dl>
      </div>
      <div class="variablelist">
        <dl>
          <dt>
            <span class="term"></span>
          </dt>
          <dd>To build the Berkeley DB SQL interface test suite, enter --enable-test as an argument to configure. This argument can also be used with either --enable-sql or --enable-sql_compat to build the SQLite Tcl test runner. </dd>
        </dl>
      </div>
      <p>The following configuration options are useful when debugging applications:</p>
      <div class="variablelist">
        <dl>
          <dt>
            <span class="term"></span>
          </dt>
          <dd>To build Berkeley DB SQL interface with symbols for debugging enter <a class="link" href="build_unix_conf.html#build_unix_conf.--enable-debug">--enable-debug</a> as an argument to configure.</dd>
          <dt>
            <span class="term"></span>
          </dt>
          <dd>To build Berkeley DB SQL interface with run-time debugging checks, enter <a class="link" href="build_unix_conf.html#build_unix_conf.--enable-diagnostic">--enable-diagnostic </a>as an argument to configure.</dd>
        </dl>
      </div>
      <p>
Any arguments that you can provide to the standard SQLite configure script can also be supplied when configuring Berkeley DB SQL interface.
</p>
      <div class="sect2" lang="en" xml:lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="id3768745"></a>Enabling Extensions</h3>
            </div>
          </div>
        </div>
        <p>The Berkeley DB SQL API provides extensions such as full text search and R-Tree index. By default, these two extensions are disabled. To enable an extension in the Berkeley DB SQL interface, specify the related option as an argument to the configure script using the standard environment variable, CPPFLAGS. 
</p>
        <div class="variablelist">
          <dl>
            <dt>
              <span class="term"></span>
            </dt>
            <dd>To enable building the full text search layer in the Berkeley DB interface, add the SQLITE_ENABLE_FTS3 option to the CPPFLAGS variable.</dd>
          </dl>
        </div>
        <div class="variablelist">
          <dl>
            <dt>
              <span class="term"></span>
            </dt>
            <dd>To enable building the R-Tree layer in the Berkeley DB interface, add the SQLITE_ENABLE_RTREE option to the CPPFLAGS variable.</dd>
          </dl>
        </div>
        <p> See the SQLite Documentation for more information on <a class="ulink" href="http://www.sqlite.org/fts3.html" target="_top">full text search</a> and <a class="ulink" href="http://www.sqlite.org/rtree.html" target="_top">R-Tree</a>.</p>
      </div>
      <div class="sect2" lang="en" xml:lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="id3770365"></a>Building the JDBC Driver
</h3>
            </div>
          </div>
        </div>
        <p>This section describes how to build the JDBC driver code using <code class="literal">autoconf</code>, which is the only method supported and tested by the Berkeley DB team.</p>
        <p>To build the JDBC driver, you must have Sun Java Development Kit 1.1 or above installed.</p>
        <pre class="programlisting">
cd build_unix
CFLAGS="-fPIC" ../dist/configure --enable-sql_compat --disable-shared
make
cd ../sql/jdbc
CFLAGS="-DHAVE_SQLITE3_MALLOC -DHAVE_ERRNO_H \ 
       -I../../build_unix -I../../dbinc" \
       LDFLAGS="../../build_unix/libdb-5.0.a" \
       ./configure --with-sqlite3=../generated  
make
</pre>
        <p>Note: The defined process is known to generate a link warning during the final step. The warning is generated by libtool when linking a library without a library information file present (.la). It is safe to ignore the warning. If you have problems when using the JDBC driver, use the shared library version of Berkeley DB.</p>
        <p>
You can test the build by entering the following commands from the <code class="literal">sql/jdbc</code> directory:
</p>
        <table class="simplelist" border="0" summary="Simple list">
          <tr>
            <td>javac -classpath ./sqlite.jar test3.java</td>
          </tr>
          <tr>
            <td>java -Djava.library.path=./.libs -classpath ./sqlite.jar:. test3 </td>
          </tr>
        </table>
        <p>
</p>
      </div>
      <div class="sect2" lang="en" xml:lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="id3770568"></a>Building the ODBC Driver</h3>
            </div>
          </div>
        </div>
        <p>
   This section describes the steps required to build the ODBC driver.</p>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="id3770477"></a>Configuring Your System</h4>
              </div>
            </div>
          </div>
          <p>
    To configure your system prior to building the ODBC driver, do the following:
    </p>
          <div class="orderedlist">
            <ol type="1">
              <li>Download and install the latest <a class="ulink" href="http://www.unixodbc.org" target="_top">unixODBC</a> if ODBC is not already installed on your system.</li>
              <li>Configure the ODBC server to work with SQLite databases. Follow <a class="ulink" href="http://www.ch-werner.de/sqliteodbc/html/index.html" target="_top">these instructions</a> from Christian Werner.</li>
            </ol>
          </div>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="id3769237"></a>Building the Library</h4>
              </div>
            </div>
          </div>
          <p>To build the library, do the following</p>
          <pre class="programlisting">
$ cd db-5.0.XX/build_unix
$ CFLAGS="-fPIC" ../dist/configure --enable-sql_compat --disable-shared
$ make
$ cd ../sql/odbc
$ CFLAGS="-DHAVE_ERRNO_H -I../../build_unix -I../../dbinc \
         -I../sqlite/src" LDFLAGS="../../build_unix/libdb-5.0.a" \ 
         ./configure --with-sqlite3=../generated
$ make
    </pre>
          <p>The <code class="literal">libsqlite3odbc.so</code> library containing a statically linked version of Berkeley DB SQL is now built.</p>
          <p>NOTE: The final <code class="literal">make</code> command above is known to generate a warning when using GCC. The warning states: <code class="literal">Warning: Linking the shared library libsqlite3odbc.la against the static library ../../build_unix/libdb-5.0.a is not portable!</code>. It is generally safe to ignore the warning when using the generated library.</p>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="id3770684"></a>Testing the ODBC Driver</h4>
              </div>
            </div>
          </div>
          <p>The steps to verify that the installed driver works are as follows:</p>
          <div class="orderedlist">
            <ol type="1">
              <li>Alter the <code class="literal">/etc/odbcinst.ini</code> and <code class="literal">~/.odbc.ini</code> configuration files to refer to the libsqlite3odbc.so file built above.</li>
              <li><p>Create a data source, and launch a data source viewer application by doing the following:</p><pre class="programlisting">$ mkdir ~/databases
$ cd ~/databases
$ /path/to/Berkeley DB/build_unix/sqlite3 mytest.db
dbsql&gt; CREATE TABLE t1(x);
dbsql&gt; .quit;
$ DataManager
</pre>
The final step opens a GUI application that displays ODBC data sources on a system. You should be able to find the <code class="literal">mytest.db</code> data source just created.</li>
            </ol>
          </div>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="build_unix_conf.html">Prev</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="build_unix.html">Up</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="build_unix_small.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">Configuring Berkeley DB </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> Building a small memory footprint library</td>
        </tr>
      </table>
    </div>
  </body>
</html>
